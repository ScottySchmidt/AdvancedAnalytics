{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "3ad95c94",
   "metadata": {
    "papermill": {
     "duration": 0.00519,
     "end_time": "2022-08-30T17:41:29.406013",
     "exception": false,
     "start_time": "2022-08-30T17:41:29.400823",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Admissions Analysis\n",
    "#### Bus471 Data Analytics\n",
    "Illinois State University; Scott Schmidt\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bfee4264",
   "metadata": {
    "papermill": {
     "duration": 0.006082,
     "end_time": "2022-08-30T17:41:29.415817",
     "exception": false,
     "start_time": "2022-08-30T17:41:29.409735",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# View Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "763cc83e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:41:29.427893Z",
     "iopub.status.busy": "2022-08-30T17:41:29.425402Z",
     "iopub.status.idle": "2022-08-30T17:42:30.894766Z",
     "shell.execute_reply": "2022-08-30T17:42:30.892846Z"
    },
    "papermill": {
     "duration": 61.478844,
     "end_time": "2022-08-30T17:42:30.898222",
     "exception": false,
     "start_time": "2022-08-30T17:41:29.419378",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Installing package into ‘/usr/local/lib/R/site-library’\n",
      "(as ‘lib’ is unspecified)\n",
      "\n",
      "also installing the dependencies ‘rJava’, ‘xlsxjars’\n",
      "\n",
      "\n",
      "Loading required package: ggplot2\n",
      "\n",
      "Loading required package: lattice\n",
      "\n",
      "\n",
      "Attaching package: ‘caret’\n",
      "\n",
      "\n",
      "The following object is masked from ‘package:httr’:\n",
      "\n",
      "    progress\n",
      "\n",
      "\n",
      "Loaded gbm 2.1.8\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 4</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>admit</th><th scope=col>gre</th><th scope=col>gpa</th><th scope=col>rank</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>0</td><td>380</td><td>3.61</td><td>3</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>1</td><td>660</td><td>3.67</td><td>3</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>1</td><td>800</td><td>4.00</td><td>1</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>1</td><td>640</td><td>3.19</td><td>4</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>0</td><td>520</td><td>2.93</td><td>4</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>1</td><td>760</td><td>3.00</td><td>2</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 4\n",
       "\\begin{tabular}{r|llll}\n",
       "  & admit & gre & gpa & rank\\\\\n",
       "  & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\t1 & 0 & 380 & 3.61 & 3\\\\\n",
       "\t2 & 1 & 660 & 3.67 & 3\\\\\n",
       "\t3 & 1 & 800 & 4.00 & 1\\\\\n",
       "\t4 & 1 & 640 & 3.19 & 4\\\\\n",
       "\t5 & 0 & 520 & 2.93 & 4\\\\\n",
       "\t6 & 1 & 760 & 3.00 & 2\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 4\n",
       "\n",
       "| <!--/--> | admit &lt;dbl&gt; | gre &lt;dbl&gt; | gpa &lt;dbl&gt; | rank &lt;dbl&gt; |\n",
       "|---|---|---|---|---|\n",
       "| 1 | 0 | 380 | 3.61 | 3 |\n",
       "| 2 | 1 | 660 | 3.67 | 3 |\n",
       "| 3 | 1 | 800 | 4.00 | 1 |\n",
       "| 4 | 1 | 640 | 3.19 | 4 |\n",
       "| 5 | 0 | 520 | 2.93 | 4 |\n",
       "| 6 | 1 | 760 | 3.00 | 2 |\n",
       "\n"
      ],
      "text/plain": [
       "  admit gre gpa  rank\n",
       "1 0     380 3.61 3   \n",
       "2 1     660 3.67 3   \n",
       "3 1     800 4.00 1   \n",
       "4 1     640 3.19 4   \n",
       "5 0     520 2.93 4   \n",
       "6 1     760 3.00 2   "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "install.packages(\"xlsx\")\n",
    "library(\"xlsx\")\n",
    "library(data.table)\n",
    "library(caret)\n",
    "library(gbm)\n",
    "\n",
    "file='../input/admissions/admissions.xlsx'\n",
    "df= read.xlsx(file, 1, header=TRUE)\n",
    "head(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "eef8eb26",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:30.941721Z",
     "iopub.status.busy": "2022-08-30T17:42:30.910899Z",
     "iopub.status.idle": "2022-08-30T17:42:30.960197Z",
     "shell.execute_reply": "2022-08-30T17:42:30.958527Z"
    },
    "papermill": {
     "duration": 0.057732,
     "end_time": "2022-08-30T17:42:30.962436",
     "exception": false,
     "start_time": "2022-08-30T17:42:30.904704",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "     admit             gre             gpa             rank      \n",
       " Min.   :0.0000   Min.   :220.0   Min.   :2.260   Min.   :1.000  \n",
       " 1st Qu.:0.0000   1st Qu.:520.0   1st Qu.:3.130   1st Qu.:2.000  \n",
       " Median :0.0000   Median :580.0   Median :3.395   Median :2.000  \n",
       " Mean   :0.3175   Mean   :587.7   Mean   :3.390   Mean   :2.485  \n",
       " 3rd Qu.:1.0000   3rd Qu.:660.0   3rd Qu.:3.670   3rd Qu.:3.000  \n",
       " Max.   :1.0000   Max.   :800.0   Max.   :4.000   Max.   :4.000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "summary(df);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6b76b33e",
   "metadata": {
    "papermill": {
     "duration": 0.006242,
     "end_time": "2022-08-30T17:42:30.974230",
     "exception": false,
     "start_time": "2022-08-30T17:42:30.967988",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Treat Missing Values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "da07ae52",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:30.988975Z",
     "iopub.status.busy": "2022-08-30T17:42:30.986300Z",
     "iopub.status.idle": "2022-08-30T17:42:31.008141Z",
     "shell.execute_reply": "2022-08-30T17:42:31.005200Z"
    },
    "papermill": {
     "duration": 0.031617,
     "end_time": "2022-08-30T17:42:31.011327",
     "exception": false,
     "start_time": "2022-08-30T17:42:30.979710",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df <- na.omit(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ca0115d7",
   "metadata": {
    "papermill": {
     "duration": 0.004607,
     "end_time": "2022-08-30T17:42:31.020225",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.015618",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Acceptance Analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "28be0066",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:31.033538Z",
     "iopub.status.busy": "2022-08-30T17:42:31.030926Z",
     "iopub.status.idle": "2022-08-30T17:42:31.057936Z",
     "shell.execute_reply": "2022-08-30T17:42:31.056263Z"
    },
    "papermill": {
     "duration": 0.035963,
     "end_time": "2022-08-30T17:42:31.060396",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.024433",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "     rank\n",
       "admit  1  2  3  4\n",
       "    0 28 97 93 55\n",
       "    1 33 54 28 12"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "xtabs(~admit + rank, data = df)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9304ff9d",
   "metadata": {
    "papermill": {
     "duration": 0.006498,
     "end_time": "2022-08-30T17:42:31.072883",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.066385",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Correlations"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "76d7c04f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:31.086851Z",
     "iopub.status.busy": "2022-08-30T17:42:31.085094Z",
     "iopub.status.idle": "2022-08-30T17:42:31.109025Z",
     "shell.execute_reply": "2022-08-30T17:42:31.106861Z"
    },
    "papermill": {
     "duration": 0.043636,
     "end_time": "2022-08-30T17:42:31.122414",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.078778",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tPearson's product-moment correlation\n",
       "\n",
       "data:  df$admit and df$gre\n",
       "t = 3.7437, df = 398, p-value = 0.0002081\n",
       "alternative hypothesis: true correlation is not equal to 0\n",
       "95 percent confidence interval:\n",
       " 0.08797348 0.27746823\n",
       "sample estimates:\n",
       "      cor \n",
       "0.1844343 \n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "cor.test(df$admit, df$gre)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "03985e9d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:31.135399Z",
     "iopub.status.busy": "2022-08-30T17:42:31.133806Z",
     "iopub.status.idle": "2022-08-30T17:42:31.152595Z",
     "shell.execute_reply": "2022-08-30T17:42:31.150591Z"
    },
    "papermill": {
     "duration": 0.028443,
     "end_time": "2022-08-30T17:42:31.155284",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.126841",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tPearson's product-moment correlation\n",
       "\n",
       "data:  df$admit and df$gpa\n",
       "t = 3.6132, df = 398, p-value = 0.0003412\n",
       "alternative hypothesis: true correlation is not equal to 0\n",
       "95 percent confidence interval:\n",
       " 0.08158617 0.27151944\n",
       "sample estimates:\n",
       "      cor \n",
       "0.1782123 \n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "cor.test(df$admit, df$gpa)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "16338875",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:31.167278Z",
     "iopub.status.busy": "2022-08-30T17:42:31.165760Z",
     "iopub.status.idle": "2022-08-30T17:42:31.184562Z",
     "shell.execute_reply": "2022-08-30T17:42:31.182434Z"
    },
    "papermill": {
     "duration": 0.027689,
     "end_time": "2022-08-30T17:42:31.187420",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.159731",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tPearson's product-moment correlation\n",
       "\n",
       "data:  df$admit and df$rank\n",
       "t = -4.987, df = 398, p-value = 9.175e-07\n",
       "alternative hypothesis: true correlation is not equal to 0\n",
       "95 percent confidence interval:\n",
       " -0.3326548 -0.1479803\n",
       "sample estimates:\n",
       "       cor \n",
       "-0.2425132 \n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "cor.test(df$admit, df$rank)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f6a801eb",
   "metadata": {
    "papermill": {
     "duration": 0.004751,
     "end_time": "2022-08-30T17:42:31.197025",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.192274",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# Logistic Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "0c35e76d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:31.209815Z",
     "iopub.status.busy": "2022-08-30T17:42:31.208086Z",
     "iopub.status.idle": "2022-08-30T17:42:31.252444Z",
     "shell.execute_reply": "2022-08-30T17:42:31.250352Z"
    },
    "papermill": {
     "duration": 0.053705,
     "end_time": "2022-08-30T17:42:31.255314",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.201609",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Call:\n",
       "glm(formula = admit ~ gre + gpa + rank, family = \"binomial\", \n",
       "    data = df)\n",
       "\n",
       "Deviance Residuals: \n",
       "    Min       1Q   Median       3Q      Max  \n",
       "-1.6268  -0.8662  -0.6388   1.1490   2.0790  \n",
       "\n",
       "Coefficients:\n",
       "             Estimate Std. Error z value Pr(>|z|)    \n",
       "(Intercept) -3.989979   1.139951  -3.500 0.000465 ***\n",
       "gre          0.002264   0.001094   2.070 0.038465 *  \n",
       "gpa          0.804038   0.331819   2.423 0.015388 *  \n",
       "rank2       -0.675443   0.316490  -2.134 0.032829 *  \n",
       "rank3       -1.340204   0.345306  -3.881 0.000104 ***\n",
       "rank4       -1.551464   0.417832  -3.713 0.000205 ***\n",
       "---\n",
       "Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
       "\n",
       "(Dispersion parameter for binomial family taken to be 1)\n",
       "\n",
       "    Null deviance: 499.98  on 399  degrees of freedom\n",
       "Residual deviance: 458.52  on 394  degrees of freedom\n",
       "AIC: 470.52\n",
       "\n",
       "Number of Fisher Scoring iterations: 4\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df$rank <- factor(df$rank)\n",
    "mylogit <- glm(admit ~ gre + gpa + rank, data = df, family = \"binomial\")\n",
    "summary(mylogit)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "de3b23ab",
   "metadata": {
    "papermill": {
     "duration": 0.005024,
     "end_time": "2022-08-30T17:42:31.265085",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.260061",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# New Result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d05244b7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-08-30T17:42:31.284581Z",
     "iopub.status.busy": "2022-08-30T17:42:31.282229Z",
     "iopub.status.idle": "2022-08-30T17:42:31.308348Z",
     "shell.execute_reply": "2022-08-30T17:42:31.306028Z"
    },
    "papermill": {
     "duration": 0.041538,
     "end_time": "2022-08-30T17:42:31.311252",
     "exception": false,
     "start_time": "2022-08-30T17:42:31.269714",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "'New File Created'"
      ],
      "text/latex": [
       "'New File Created'"
      ],
      "text/markdown": [
       "'New File Created'"
      ],
      "text/plain": [
       "[1] \"New File Created\""
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "newFile=\"results.csv\"\n",
    "fwrite(df, newFile)\n",
    "paste(\"New File Created\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.0.5"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 65.768424,
   "end_time": "2022-08-30T17:42:31.437061",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2022-08-30T17:41:25.668637",
   "version": "2.3.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
